{% extends "base.html" %}{% load markup %}

{% block page_title %}{{ subject.name }}{% if story %} {{ story.slug }}{% endif %}{% endblock %}

{% block content %}
<h1>{{subject.name}}{% if story %} (in &ldquo;{{story}}&rdquo;){% endif %}</h1>

<ol>
{% if story and story.prev %}
<li><a rel='prev' href='{{story.prev.url}}?story={{story.slug}}'>Previous: {{ story.prev.name }}</a></li>
{% endif %}

{% if story and story.next %}
<li><a rel='next' href='{{story.next.url}}?story={{story.slug}}'>Next: {{ story.next.name }}</a></li>
{% endif %}
</ol>

{% if user.is_authenticated %}
<a href="/admin/core/{{ subject.object_name }}/{{ subject.pk }}/">Edit in Admin</a>
{% if story.story_content %}
<a href="/admin/core/storycontent/{{ story.story_content.pk }}/">Edit Story Content</a>
{% else %}
<a href="/admin/core/storycontent/add/?">Add Story Content</a>
{% endif %}
{% endif %}

{{subject.text|textile}}

{% if story.story_content %}
  <h2>Current story content</h2>
  <ul>
    <li>{{story.story_content.text|linebreaks}}</li>
  </ul>
{% endif %}

{% if subject.reference_url %}
<a href='{{ subject.reference_url }}'>Read on Weaver</a>
{% endif %}
<hr>

<h2>Other stories</h2>
{% for other_story in subject.stories %}
{% if other_story != story %}
    <h3>{{other_story.name}}</h3>
    <ol>
    {% if other_story.next %}<li>Next: <a href='{{other_story.next.url}}?story={{other_story.slug}}'>{{other_story.next.name}}</a></li>{% endif %}
    {% if other_story.previous %}<li>Previous: <a href='{{other_story.previous.url}}?story={{other_story.slug}}'>{{other_story.previous.name}}</a></li>{% endif %}
    </ol>
    {{other_story.story_content.text|linebreaks}}
{% endif %}
{% endfor %}

{% include "nodes/links.html" %}
{% endblock %}
